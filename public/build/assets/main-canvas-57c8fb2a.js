import{D as A,m as oe,a5 as M,o as n,c as m,J as r,a as w,u as l,e as p,b as h,y as ne,I as Y,f as C,F as ae,h as k,_ as D,r as se,a6 as H,q as ie,G as X,H as le}from"./app-06066091.js";import{u as E,P as re,_ as de,C as ue,a as ce}from"./vue-flow-core-09b5630a.js";import fe from"./start-node-6db26e8d.js";import me from"./Buttons-node-6748d497.js";import pe from"./List-node-68886acd.js";import ve from"./Media-node-faa65637.js";import he from"./Text-node-a6b0ae71.js";import{_ as we}from"./_plugin-vue_export-helper-c27b6911.js";import"./FormSelect-6c96738a.js";import"./index-8e47e887.js";import"./hidden-94645dc9.js";import"./use-text-value-6338b60a.js";import"./use-outside-click-6f649936.js";import"./use-resolve-button-type-737f9372.js";import"./FormTextArea-248be5f8.js";import"./ellipsis-479b8917.js";import"./createLucideIcon-61c243d3.js";import"./Menubar-fd4e5999.js";import"./index-4364f7ce.js";import"./utils-9d1e612c.js";import"./MenubarItem-683c51fa.js";import"./MenubarContent-4d16dab4.js";import"./MenubarMenu-ddb5e274.js";import"./MenubarTrigger-3fe0db01.js";import"./FormInput-a5364d31.js";import"./FlowMedia-c420161f.js";var f=(e=>(e.Lines="lines",e.Dots="dots",e))(f||{});const U=function({dimensions:e,size:o,color:a}){return Y("path",{stroke:a,"stroke-width":o,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})},J=function({radius:e,color:o}){return Y("circle",{cx:e,cy:e,r:e,fill:o})};f.Lines+"",f.Dots+"";const ge={[f.Dots]:"#81818a",[f.Lines]:"#eee"},_e=["id","x","y","width","height","patternTransform"],$e={key:2,height:"100",width:"100"},ye=["fill"],ze=["x","y","fill"],Ce={name:"Background",compatConfig:{MODE:3}},ke=A({...Ce,props:{id:{},variant:{default:()=>f.Dots},gap:{default:20},size:{default:1},lineWidth:{default:1},patternColor:{},color:{},bgColor:{},height:{default:100},width:{default:100},x:{default:0},y:{default:0},offset:{default:2}},setup(e){const{id:o,viewport:a}=E(),i=oe(()=>{const[t,_]=Array.isArray(e.gap)?e.gap:[e.gap,e.gap],$=[t*a.value.zoom||1,_*a.value.zoom||1],v=e.size*a.value.zoom,V=e.variant===f.Dots?[v/e.offset,v/e.offset]:[$[0]/e.offset,$[1]/e.offset];return{scaledGap:$,offset:V,size:v}}),u=M(()=>`pattern-${o}${e.id?`-${e.id}`:""}`),g=M(()=>e.color||e.patternColor||ge[e.variant||f.Dots]);return(t,_)=>(n(),m("svg",{class:"vue-flow__background vue-flow__container",style:ne({height:`${t.height>100?100:t.height}%`,width:`${t.width>100?100:t.width}%`})},[r(t.$slots,"pattern-container",{id:u.value},()=>[w("pattern",{id:u.value,x:l(a).x%i.value.scaledGap[0],y:l(a).y%i.value.scaledGap[1],width:i.value.scaledGap[0],height:i.value.scaledGap[1],patternTransform:`translate(-${i.value.offset[0]},-${i.value.offset[1]})`,patternUnits:"userSpaceOnUse"},[r(t.$slots,"pattern",{},()=>[t.variant===l(f).Lines?(n(),p(l(U),{key:0,size:t.lineWidth,color:g.value,dimensions:i.value.scaledGap},null,8,["size","color","dimensions"])):t.variant===l(f).Dots?(n(),p(l(J),{key:1,color:g.value,radius:i.value.size/t.offset},null,8,["color","radius"])):h("",!0),t.bgColor?(n(),m("svg",$e,[w("rect",{width:"100%",height:"100%",fill:t.bgColor},null,8,ye)])):h("",!0)])],8,_e)]),w("rect",{x:t.x,y:t.y,width:"100%",height:"100%",fill:`url(#${u.value})`},null,8,ze),r(t.$slots,"default",{id:u.value})],4))}}),Ve={name:"ControlButton",compatConfig:{MODE:3}},be=(e,o)=>{const a=e.__vccOpts||e;for(const[i,u]of o)a[i]=u;return a},De={class:"vue-flow__controls-button"};function He(e,o,a,i,u,g){return n(),m("button",De,[r(e.$slots,"default")])}const x=be(Ve,[["render",He]]),Me={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Be=w("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),Ie=[Be];function Ne(e,o){return n(),m("svg",Me,Ie)}const xe={render:Ne},Oe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},Le=w("path",{d:"M0 0h32v4.2H0z"},null,-1),Se=[Le];function Pe(e,o){return n(),m("svg",Oe,Se)}const Fe={render:Pe},Te={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},Ae=w("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0 0 27.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94a.919.919 0 0 1-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"},null,-1),Ee=[Ae];function Ze(e,o){return n(),m("svg",Te,Ee)}const Ge={render:Ze},Re={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Xe=w("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"},null,-1),Ye=[Xe];function Ue(e,o){return n(),m("svg",Re,Ye)}const Je={render:Ue},je={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},We=w("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 0 0 0 13.714v15.238A3.056 3.056 0 0 0 3.048 32h18.285a3.056 3.056 0 0 0 3.048-3.048V13.714a3.056 3.056 0 0 0-3.048-3.047zM12.19 24.533a3.056 3.056 0 0 1-3.047-3.047 3.056 3.056 0 0 1 3.047-3.048 3.056 3.056 0 0 1 3.048 3.048 3.056 3.056 0 0 1-3.048 3.047z"},null,-1),qe=[We];function Ke(e,o){return n(),m("svg",je,qe)}const Qe={render:Ke},et={name:"Controls",compatConfig:{MODE:3}},tt=A({...et,props:{showZoom:{type:Boolean,default:!0},showFitView:{type:Boolean,default:!0},showInteractive:{type:Boolean,default:!0},fitViewParams:{},position:{default:()=>re.BottomLeft}},emits:["zoomIn","zoomOut","fitView","interactionChange"],setup(e,{emit:o}){const{nodesDraggable:a,nodesConnectable:i,elementsSelectable:u,setInteractive:g,zoomIn:t,zoomOut:_,fitView:$,viewport:v,minZoom:V,maxZoom:O}=E(),z=M(()=>a.value||i.value||u.value),L=M(()=>v.value.zoom<=V.value),Z=M(()=>v.value.zoom>=O.value);function b(){t(),o("zoomIn")}function B(){_(),o("zoomOut")}function I(){$(e.fitViewParams),o("fitView")}function S(){g(!z.value),o("interactionChange",!z.value)}return(s,P)=>(n(),p(l(de),{class:"vue-flow__controls",position:s.position},{default:C(()=>[r(s.$slots,"top"),s.showZoom?(n(),m(ae,{key:0},[r(s.$slots,"control-zoom-in",{},()=>[k(x,{class:"vue-flow__controls-zoomin",disabled:Z.value,onClick:b},{default:C(()=>[r(s.$slots,"icon-zoom-in",{},()=>[(n(),p(D(l(xe))))])]),_:3},8,["disabled"])]),r(s.$slots,"control-zoom-out",{},()=>[k(x,{class:"vue-flow__controls-zoomout",disabled:L.value,onClick:B},{default:C(()=>[r(s.$slots,"icon-zoom-out",{},()=>[(n(),p(D(l(Fe))))])]),_:3},8,["disabled"])])],64)):h("",!0),s.showFitView?r(s.$slots,"control-fit-view",{key:1},()=>[k(x,{class:"vue-flow__controls-fitview",onClick:I},{default:C(()=>[r(s.$slots,"icon-fit-view",{},()=>[(n(),p(D(l(Ge))))])]),_:3})]):h("",!0),s.showInteractive?r(s.$slots,"control-interactive",{key:2},()=>[s.showInteractive?(n(),p(x,{key:0,class:"vue-flow__controls-interactive",onClick:S},{default:C(()=>[z.value?r(s.$slots,"icon-unlock",{key:0},()=>[(n(),p(D(l(Qe))))]):h("",!0),z.value?h("",!0):r(s.$slots,"icon-lock",{key:1},()=>[(n(),p(D(l(Je))))])]),_:3})):h("",!0)]):h("",!0),r(s.$slots,"default")]),_:3},8,["position"]))}}),ot={nodes:[{type:"LLM",data:{title:"LLM",output:[{name:"output1",type:"",description:"balabala"}]},events:{},id:"1",position:{x:-413.62574973269915,y:110.25705825948319},label:"LLM node"},{type:"code",data:{title:"code",output:[{name:"key0",type:"String",description:"just for test"}]},events:{},id:"2",position:{x:262.70018202243125,y:-104.44788021583054},label:"code node"},{type:"knowledge",data:{title:"knowledge",output:[{name:"output"}]},events:{},id:"3",position:{x:939.64275630104,y:51.1990333957562},label:"knowledge node"}],edges:[{sourceHandle:"1__handle-right",targetHandle:"2__handle-left",type:"default",source:"1",target:"2",data:{},events:{},id:"vueflow__edge-11__handle-right-22__handle-left",sourceX:200.40522146581822,sourceY:488.25689832215323,targetX:253.70017309626013,targetY:364.55198874414043},{sourceHandle:"2__handle-right",targetHandle:"3__handle-left",type:"default",source:"2",target:"3",data:{},events:{},id:"vueflow__edge-22__handle-right-33__handle-left",sourceX:871.6999267177814,sourceY:364.55198874414043,targetX:930.6427473748689,targetY:342.1989975362437}],position:[-151.90460217317343,183.68497815279642],zoom:.5802807591037111,viewport:{x:-151.90460217317343,y:183.68497815279642,zoom:.5802807591037111}},nt=A({__name:"main-canvas",props:["uuid","flow"],emits:["updateStatus","updatePayload"],setup(e,{emit:o}){const a=e,i=se(),u={start:H(fe),list:H(pe),buttons:H(me),media:H(ve),text:H(he)},{findNode:g,nodes:t,edges:_,viewport:$,addNodes:v,addEdges:V,project:O,vueFlowRef:z,onConnect:L,onNodeDragStop:Z,setNodes:b,setEdges:B,setViewport:I,onViewportChange:S}=E();ie(()=>{if(a.flow.metadata){const d=JSON.parse(a.flow.metadata);b(d.nodes||[]),B(d.edges||[]),I(d.viewport||[])}else b([{id:"1",type:"start",label:"start",position:{x:25,y:10},data:{uuid:a.uuid,title:"start",metadata:{fields:[]}}}])}),X([t,_],()=>{P()},{deep:!0}),L(d=>{V(d)}),S(()=>{P()});const s=o,P=()=>{s("updatePayload",JSON.stringify({nodes:t.value,edges:_.value,viewport:$.value}))};function j(d){var R;const y=(R=d.dataTransfer)==null?void 0:R.getData("application/vueflow");if(y==="workflow"){const{nodes:c,edges:T,position:N,zoom:Q}=ot,[ee=0,te=0]=N;b(c),B(T),I({x:ee,y:te,zoom:Q||0});return}const{left:F,top:q}=z.value.getBoundingClientRect(),K=O({x:d.clientX-F,y:d.clientY-q}),G={id:((t.value.length?Math.max(...t.value.map(c=>parseInt(c.id,10)))+1:1)+1).toString(),type:y,position:K,label:`${y} node`,data:{uuid:a.uuid,title:y,metadata:{fields:[]}}};v([G]),le(()=>{const c=g(G.id),T=X(()=>c.dimensions,N=>{N.width>0&&N.height>0&&c&&(c.position={x:c.position.x-c.dimensions.width/2,y:c.position.y-c.dimensions.height/2},T())},{deep:!0,flush:"post"})})}function W(d){d.preventDefault(),d.dataTransfer&&(d.dataTransfer.dropEffect="move")}return(d,y)=>(n(),m("div",{class:"relative h-full w-full",id:"main-canvas",onDrop:j,onDragover:W},[k(l(ce),{modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=F=>i.value=F),"node-types":u,"connection-mode":l(ue).Strict},{default:C(()=>[k(l(tt)),k(l(ke))]),_:1},8,["modelValue","connection-mode"])],32))}});const It=we(nt,[["__file","main-canvas.vue"]]);export{It as default};
