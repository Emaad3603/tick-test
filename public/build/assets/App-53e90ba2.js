import{$ as b,a0 as S,r as i,m as l,K as a,G as k,q as C,c as M,h,a as c,J as T,n as A,F as P,o as E}from"./app-06066091.js";import N from"./Sidebar-56399b82.js";import{l as x}from"./index-2177aed8.js";import O from"./MobileSidebar-c9250509.js";/* empty css              */import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";let d=null;function j(g,s){return d||(window.Pusher=b,d=new S({broadcaster:"pusher",key:g,cluster:s,encrypted:!0})),d}const F={class:"md:min-h-screen flex flex-col w-full min-w-0"},I={__name:"App",setup(g){const s=i(!0),u=l(()=>a().props.auth.user),p=l(()=>a().props.config),r=l(()=>a().props.organization),v=l(()=>a().props.organizations),y=l(()=>a().props.title),_=l(()=>a().props.allowCreate),f=i(a().props.unreadMessages),t=i(null);k(()=>[a().props.flash,{deep:!0}],()=>{a().props.flash.status!=null&&x(a().props.flash.status.message,{autoClose:3e3})});const z=()=>{s.value=!s.value},m=o=>{const e=p.value.find(n=>n.key===o);return e?e.value:""},w=()=>{const e=(r.value.metadata?JSON.parse(r.value.metadata):{}).notifications||{};e!=null&&e.enable_sound&&t.value&&(t.value.src=e==null?void 0:e.tone,t.value.volume=(e==null?void 0:e.volume)||1)},B=()=>{t.value&&t.value.play().catch(o=>{console.warn("Audio playback failed:",o)})};return C(()=>{w(),j(m("pusher_app_key"),m("pusher_app_cluster")).channel("chats.ch"+r.value.id).listen("NewChatEvent",e=>{const n=e.chat;n[0].value.deleted_at==null&&n[0].value.type==="inbound"&&(B(),f.value+=1)})}),(o,e)=>(E(),M(P,null,[h(O,{user:u.value,config:p.value,organization:r.value,organizations:v.value,title:y.value,displayCreateBtn:_.value,displayTopBar:s.value},null,8,["user","config","organization","organizations","title","displayCreateBtn","displayTopBar"]),c("div",{class:A(["md:mt-0 md:pt-0 flex md:h-screen w-full tracking-[0.3px] bg-gray-300/10",s.value===!1?"mt-0 pt-0":""])},[h(N,{user:u.value,config:p.value,organization:r.value,organizations:v.value,unreadMessages:f.value},null,8,["user","config","organization","organizations","unreadMessages"]),c("div",F,[T(o.$slots,"default",{user:u.value,toggleNavBar:z,onTestEmit:e[0]||(e[0]=(...n)=>o.doSomething&&o.doSomething(...n))})])],2),c("audio",{ref_key:"audioPlayer",ref:t,allow:"autoplay"},null,512)],64))}},J=V(I,[["__file","App.vue"]]),H=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as A,H as a,j as g};
