import{T as k,r as c,c as d,h as l,f as r,u as a,k as L,F as p,o as u,g,t as i,d as h,e as T,a as e,b as Z,n as _,j as $}from"./app-06066091.js";import"./_baseGetTag-c09aeb4c.js";import{A as z}from"./AlertModal-04f87487.js";import{u as H}from"./useAlertModal-20c1d6c7.js";/* empty css              */import{F as q}from"./FormCheckbox-a2588781.js";import{F as G}from"./FormInput-a5364d31.js";import{M as B}from"./Modal-858f9f8a.js";import{T as J}from"./Table-593fb9c4.js";import{T as K,a as P,b as C}from"./TableHeaderRowItem-58f056c6.js";import{T as Q,b as V,a as X}from"./TableBodyRowItem-f7a16ee1.js";import{D as Y}from"./Dropdown-82fc851d.js";import{D as ee,a as O}from"./DropdownItem-f7277231.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./transition-9e93c540.js";import"./hidden-94645dc9.js";import"./use-outside-click-6f649936.js";import"./micro-task-89dcd6af.js";import"./Pagination-d90e3b69.js";import"./use-text-value-6338b60a.js";import"./use-tree-walker-26135af6.js";import"./use-resolve-button-type-737f9372.js";const se={class:"flex"},oe={class:"text-left mr-3 text-sm relative w-[10em] truncate"},le={class:"py-1 px-2 bg-gray-50 rounded-[5px] border border-dashed w-[20em] truncate text-xs capitalize"},re={class:"flex items-center"},ne=["onClick"],ae=e("button",{class:"inline-flex w-full justify-center rounded-md text-sm font-medium text-black hover:bg-opacity-30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"},[e("span",{class:"hover:bg-[#F6F7F9] hover:rounded-full w-[fit-content] p-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 16a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2Z"})])])],-1),ie={class:"mt-5 grid grid-cols-1 gap-x-6"},ue={class:"mt-4 text-sm"},de={class:"mt-4 flex"},ce=["disabled"],me={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},pe=e("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".5"},null,-1),fe=e("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},[e("animateTransform",{attributeName:"transform",dur:"1s",from:"0 12 12",repeatCount:"indefinite",to:"360 12 12",type:"rotate"})],-1),be=[pe,fe],ve={key:1},ge={class:"mt-5 grid grid-cols-1 gap-x-6"},he=e("h4",{class:"mb-2"},"Webhook URL",-1),_e={class:"text-sm bg-slate-100 py-1 rounded-md px-2"},we={class:"mt-4"},ye=e("h4",{class:"mb-2"},"Events",-1),xe={class:"flex items-center justify-between border-b py-1 text-sm"},ke={class:"capitalize"},Te=["onClick"],$e={class:"grid gap-x-6 sm:grid-cols-6"},Ce={class:"mt-4 flex"},Ve={__name:"WebhookTable",props:{rows:{type:Object,required:!0},events:{type:Object}},emits:["delete"],setup(w,{emit:Ae}){const A=w,{isOpenAlert:y,openAlert:R,confirmAlert:j}=H(),M=k({test:null});c(null),c(null);const f=c(!1),x=c(!1),F=c(null),D=t=>{M.delete("/developer-tools/webhooks/"+t)},E=t=>t===A.rows.data.length-1,n=k({url:null,events:[]}),N=t=>{n.url=t.url,n.events=t.events.map(o=>o.event),f.value=!0},U=t=>{n.url=t.url,n.events=t.events.map(o=>o.event),x.value=!0},S=k({url:null}),b=c(null),W=(t,o)=>{S.url=t,b.value=o,S.post(`/webhooks/trigger/${o}/test`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{b.value=null},onError:()=>{b.value=null}})},I=async()=>{n.post("/developer-tools/webhooks/"+F.value,{preserveScroll:!0,preserveState:!1,onSuccess:()=>{f.value=!1}})};return(t,o)=>(u(),d(p,null,[l(J,{rows:w.rows},{default:r(()=>[l(K,null,{default:r(()=>[l(P,null,{default:r(()=>[l(C,{position:"first"},{default:r(()=>[g(i(t.$t("Notification URL")),1)]),_:1}),l(C,null,{default:r(()=>[g(i(t.$t("Events")),1)]),_:1}),l(C,{position:"last"})]),_:1})]),_:1}),l(Q,null,{default:r(()=>[(u(!0),d(p,null,h(w.rows.data,(s,m)=>(u(),T(X,{key:m,class:_(E(m)?"":"border-b")},{default:r(()=>[l(V,{position:"first"},{default:r(()=>[e("div",se,[e("div",oe,[e("span",null,i(s.url),1)])])]),_:2},1024),l(V,{class:"hidden sm:table-cell"},{default:r(()=>[e("div",le,[(u(!0),d(p,null,h(s.events,v=>(u(),d("span",null,i(v.event)+", ",1))),256))])]),_:2},1024),l(V,{position:"last"},{default:r(()=>[e("div",re,[e("button",{onClick:v=>U(s),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},"Test",8,ne),s.role!="admin"?(u(),T(Y,{key:0,align:"right",class:"mt-2"},{items:r(()=>[l(ee,null,{default:r(()=>[l(O,{as:"button",onClick:v=>{N(s),F.value=s.uuid}},{default:r(()=>[g(i(t.$t("View/edit")),1)]),_:2},1032,["onClick"]),l(O,{as:"button",onClick:v=>a(R)(s.uuid)},{default:r(()=>[g(i(t.$t("Delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:r(()=>[ae]),_:2},1024)):Z("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1},8,["rows"]),l(B,{label:t.$t("Edit/View Webhook"),isOpen:f.value},{default:r(()=>[e("div",ie,[e("form",{onSubmit:o[3]||(o[3]=$(s=>I(),["prevent"])),class:"grid gap-x-6 sm:grid-cols-6"},[l(G,{modelValue:a(n).url,"onUpdate:modelValue":o[0]||(o[0]=s=>a(n).url=s),error:a(n).errors.url,name:t.$t("URL"),type:"text",class:_("sm:col-span-6")},null,8,["modelValue","error","name"]),e("h4",ue,i(t.$t("Events")),1),(u(!0),d(p,null,h(A.events,s=>(u(),T(q,{key:s,modelValue:a(n).events,"onUpdate:modelValue":o[1]||(o[1]=m=>a(n).events=m),error:a(n).errors.events,name:t.$t(s),label:t.$t(s),value:s,type:"text",class:_("sm:col-span-6")},null,8,["modelValue","error","name","label","value"]))),128)),e("div",de,[e("button",{type:"button",onClick:o[2]||(o[2]=$(s=>f.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(t.$t("Cancel")),1),e("button",{class:_(["inline-flex justify-center rounded-md border border-transparent bg-primary px-4 py-2 text-sm text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",{"opacity-50":a(M).processing}]),disabled:a(n).processing},[a(n).processing?(u(),d("svg",me,be)):(u(),d("span",ve,i(t.$t("Save")),1))],10,ce)])],32)])]),_:1},8,["label","isOpen"]),l(B,{label:t.$t("Test Webhook Notifications"),isOpen:x.value},{default:r(()=>[e("div",ge,[e("div",null,[he,e("h5",_e,i(a(n).url),1)]),e("div",we,[ye,(u(!0),d(p,null,h(a(n).events,s=>(u(),d("div",null,[e("div",xe,[e("div",null,[e("span",ke,i(s),1)]),e("div",null,[e("button",{onClick:m=>W(a(n).url,s),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},i(b.value===s?"Sending...":"Test"),9,Te)])])]))),256))]),e("div",$e,[e("div",Ce,[e("button",{type:"button",onClick:o[4]||(o[4]=$(s=>x.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(t.$t("Cancel")),1)])])])]),_:1},8,["label","isOpen"]),l(z,{modelValue:a(y),"onUpdate:modelValue":o[5]||(o[5]=s=>L(y)?y.value=s:null),onConfirm:o[6]||(o[6]=()=>a(j)(D)),label:t.$t("Delete row"),description:t.$t("Are you sure you want to delete this row? This action can not be undone")},null,8,["modelValue","label","description"])],64))}},Qe=te(Ve,[["__file","WebhookTable.vue"]]);export{Qe as default};
